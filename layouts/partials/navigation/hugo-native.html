{{/* 
  Fixed Hugo-Native Navigation System
  - Left sidebar navigation (desktop)
  - Top navigation (mobile)
  - Home page link
  - Responsive design
*/}}

<nav class="site-nav">
  {{/* Mobile Header */}}
  <div class="mobile-header">
    <div class="mobile-nav-container">
      <a href="{{ .Site.BaseURL }}" class="mobile-brand">
        <img src="/favicon.png" alt="{{ .Site.Title }}" class="mobile-logo">
        <span class="mobile-brand-text">{{ .Site.Title }}</span>
      </a>
      
      <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
        <span class="hamburger"></span>
        <span class="hamburger"></span>
        <span class="hamburger"></span>
      </button>
    </div>
    
    {{/* Mobile Menu Dropdown */}}
    <div class="mobile-menu" id="mobile-menu">
      <div class="mobile-menu-content">
        <a href="{{ .Site.BaseURL }}" class="mobile-menu-item"> Home</a>
        {{ range .Site.Menus.main }}
        <a href="{{ .URL }}" class="mobile-menu-item">{{ .Name }}</a>
        {{ end }}
        <a href="/search/" class="mobile-menu-item"> Search</a>
        <a href="/offerings/delphi/sign-up/" class="mobile-menu-cta">Get Started</a>
      </div>
    </div>
  </div>

  {{/* Desktop Sidebar */}}
  <aside class="sidebar">
    <div class="sidebar-content">
      {{/* Brand */}}
      <div class="sidebar-brand">
        <a href="{{ .Site.BaseURL }}" class="sidebar-brand-link">
          <img src="/favicon.png" alt="{{ .Site.Title }}" class="sidebar-logo">
          <div class="sidebar-brand-text">
            <span class="brand-name">Code Monkey</span>
            <span class="brand-subtitle">Cybersecurity</span>
          </div>
        </a>
      </div>

      {{/* Search */}}
      <div class="sidebar-search">
        <form action="/search/" method="get" class="search-form">
          <input type="search" name="q" placeholder="Search..." class="search-input">
          <button type="submit" class="search-button"></button>
        </form>
      </div>

      {{/* Main Navigation */}}
      <nav class="sidebar-nav">
        <ul class="nav-list">
          <li class="nav-item">
            <a href="{{ .Site.BaseURL }}" class="nav-link home-link">
              <span class="nav-icon"></span>
              <span class="nav-text">Home</span>
            </a>
          </li>
          
          {{ range .Site.Menus.main }}
          {{ $isActive := or (eq .URL $.RelPermalink) ($.IsMenuCurrent "main" .) ($.HasMenuCurrent "main" .) }}
          <li class="nav-item{{ if $isActive }} active{{ end }}">
            {{ if .HasChildren }}
            <div class="nav-group">
              <span class="nav-group-title">{{ .Name }}</span>
              <ul class="nav-sublist">
                {{ range .Children }}
                {{ $childActive := or (eq .URL $.RelPermalink) ($.IsMenuCurrent "main" .) ($.HasMenuCurrent "main" .) }}
                <li class="nav-subitem{{ if $childActive }} active{{ end }}">
                  <a href="{{ .URL }}" class="nav-sublink">{{ .Name }}</a>
                </li>
                {{ end }}
              </ul>
            </div>
            {{ else }}
            <a href="{{ .URL }}" class="nav-link">
              <span class="nav-text">{{ .Name }}</span>
            </a>
            {{ end }}
          </li>
          {{ end }}
        </ul>
      </nav>

      {{/* Call to Action */}}
      <div class="sidebar-cta">
        <a href="/offerings/delphi/sign-up/" class="cta-button">
          Get Started
        </a>
      </div>

      {{/* Footer Info */}}
      <div class="sidebar-footer">
        <p class="footer-text">Fremantle, WA</p>
        <p class="footer-text">ABN: {{ .Site.Params.abn }}</p>
      </div>
    </div>
  </aside>
</nav>

<script>
function toggleMobileMenu() {
  const menu = document.getElementById('mobile-menu');
  menu.classList.toggle('open');
}

// Close mobile menu when clicking outside
document.addEventListener('click', function(event) {
  const menu = document.getElementById('mobile-menu');
  const toggle = document.querySelector('.mobile-menu-toggle');
  
  if (!menu.contains(event.target) && !toggle.contains(event.target)) {
    menu.classList.remove('open');
  }
});
</script>