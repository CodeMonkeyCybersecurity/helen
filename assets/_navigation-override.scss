// Complete Hugo Book Theme Navigation Override
// This file completely replaces the book theme navigation system

// Import variables
@import "defaults";

// Completely disable Hugo Book theme navigation
#menu-control,
label[for="menu-control"],
.book-menu-overlay,
.book-header .book-menu-content {
  display: none !important;
}

// Override ALL theme menu behavior
#menu-control:checked ~ main .book-menu,
#menu-control:checked ~ main .book-page,
#menu-control:focus ~ main label[for="menu-control"],
.book-menu-overlay {
  all: unset !important;
}

// Complete sidebar override with Alpine.js control
.book-menu {
  // Reset all Hugo Book theme styles
  all: unset;
  
  // Apply our custom styles
  display: block;
  flex: 0 0 $menu-width;
  background: $nav-background;
  border-right: 1px solid rgba($bg-section-neutral, 0.8);
  
  // Mobile behavior (< 768px): Hidden by default, togglable
  @media screen and (max-width: #{$mobile-breakpoint - 1px}) {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: $menu-width !important;
    height: 100vh !important;
    z-index: 45 !important;
    transform: translateX(-100%) !important;
    transition: transform 300ms ease !important;
    box-shadow: none !important;
    
    // When menu is open (Alpine.js controlled)
    &.menu-open {
      transform: translateX(0) !important;
      box-shadow: 0 0 1rem rgba(0, 0, 0, 0.2) !important;
    }
  }
  
  // Desktop behavior (â‰¥ 768px): Always visible, sticky positioned
  @media screen and (min-width: #{$mobile-breakpoint}) {
    position: sticky !important;
    top: 0 !important;
    height: 100vh !important;
    transform: translateX(0) !important;
    z-index: 10 !important;
    box-shadow: none !important;
  }
  
  // Menu content container
  .book-menu-content {
    position: relative;
    width: 100%;
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding: 1rem;
    background: $nav-background;
  }
}

// Page content adjustments
.book-page {
  flex: 1;
  min-width: 0;
  background: $bg-light;
  
  @media screen and (max-width: #{$mobile-breakpoint - 1px}) {
    // Full width on mobile
    width: 100%;
  }
  
  @media screen and (min-width: #{$mobile-breakpoint}) {
    // Adjust for sidebar on desktop
    margin-left: 0;
  }
}

// Mobile overlay when menu is open
body.has-unified-nav {
  @media screen and (max-width: #{$mobile-breakpoint - 1px}) {
    // Add overlay styles are handled in baseof.html
    
    // Prevent scrolling when mobile menu is open
    &:has(.book-menu.menu-open) {
      overflow: hidden;
    }
  }
}

// Header behavior override
.book-header {
  // Mobile: Show our custom header
  @media screen and (max-width: #{$mobile-breakpoint - 1px}) {
    display: block !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 50 !important;
    background: white !important;
    border-bottom: 1px solid rgba($bg-section-neutral, 0.8) !important;
  }
  
  // Desktop: Hide header, sidebar handles navigation
  @media screen and (min-width: #{$mobile-breakpoint}) {
    display: none !important;
  }
}

// Container layout fixes
.container {
  display: flex;
  min-height: 100vh;
  max-width: none !important;
  margin: 0 !important;
  padding: 0 !important;
}

// Ensure proper z-index layering
nav {
  z-index: 50;
}

.book-menu.menu-open {
  z-index: 45;
}

// Mobile menu overlay from baseof.html
.mobile-menu-overlay {
  z-index: 40;
}